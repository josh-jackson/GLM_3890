<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>GLM 2024 - GLM basics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">GLM 2024</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./lectures.html" rel="" target="">
 <span class="menu-text">Lectures</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./homework.html" rel="" target="">
 <span class="menu-text">homework</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./syllabus.html" rel="" target="">
 <span class="menu-text">Syllabus</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#thinking-in-terms-of-models" id="toc-thinking-in-terms-of-models" class="nav-link active" data-scroll-target="#thinking-in-terms-of-models">Thinking in terms of models</a></li>
  <li><a href="#how-can-we-visualize-data-to-make-sense-of-it" id="toc-how-can-we-visualize-data-to-make-sense-of-it" class="nav-link" data-scroll-target="#how-can-we-visualize-data-to-make-sense-of-it">How can we visualize data to make sense of it?</a></li>
  <li><a href="#how-do-we-visualize-categorical-data" id="toc-how-do-we-visualize-categorical-data" class="nav-link" data-scroll-target="#how-do-we-visualize-categorical-data">How do we visualize categorical data?</a></li>
  <li><a href="#what-do-these-visualizations-have-in-common" id="toc-what-do-these-visualizations-have-in-common" class="nav-link" data-scroll-target="#what-do-these-visualizations-have-in-common">What do these visualizations have in common?</a></li>
  <li><a href="#thinking-in-terms-of-models-1" id="toc-thinking-in-terms-of-models-1" class="nav-link" data-scroll-target="#thinking-in-terms-of-models-1">Thinking in terms of models</a></li>
  <li><a href="#see-this-in-our-r-code" id="toc-see-this-in-our-r-code" class="nav-link" data-scroll-target="#see-this-in-our-r-code">See this in our R code</a></li>
  <li><a href="#comparison-across-these-three-models" id="toc-comparison-across-these-three-models" class="nav-link" data-scroll-target="#comparison-across-these-three-models">Comparison across these three models</a></li>
  <li><a href="#general-linear-model-glm" id="toc-general-linear-model-glm" class="nav-link" data-scroll-target="#general-linear-model-glm">General linear model (GLM)</a></li>
  <li><a href="#regression-equation" id="toc-regression-equation" class="nav-link" data-scroll-target="#regression-equation">Regression Equation</a></li>
  <li><a href="#regression-terms" id="toc-regression-terms" class="nav-link" data-scroll-target="#regression-terms">Regression terms</a></li>
  <li><a href="#regression-models" id="toc-regression-models" class="nav-link" data-scroll-target="#regression-models">Regression models</a></li>
  <li><a href="#another-example" id="toc-another-example" class="nav-link" data-scroll-target="#another-example">Another example</a></li>
  <li><a href="#example-summary" id="toc-example-summary" class="nav-link" data-scroll-target="#example-summary">Example summary</a></li>
  <li><a href="#parts-of-the-model" id="toc-parts-of-the-model" class="nav-link" data-scroll-target="#parts-of-the-model">Parts of the model</a></li>
  <li><a href="#what-do-the-estimates-tell-us" id="toc-what-do-the-estimates-tell-us" class="nav-link" data-scroll-target="#what-do-the-estimates-tell-us">What do the estimates tell us?</a></li>
  <li><a href="#how-to-interpret-regression-estimates" id="toc-how-to-interpret-regression-estimates" class="nav-link" data-scroll-target="#how-to-interpret-regression-estimates">How to interpret regression estimates</a></li>
  <li><a href="#how-to-interpret-regression-estimates-1" id="toc-how-to-interpret-regression-estimates-1" class="nav-link" data-scroll-target="#how-to-interpret-regression-estimates-1">How to interpret regression estimates</a></li>
  <li><a href="#standard-errors" id="toc-standard-errors" class="nav-link" data-scroll-target="#standard-errors">Standard errors</a></li>
  <li><a href="#sampling-distribution-refresher" id="toc-sampling-distribution-refresher" class="nav-link" data-scroll-target="#sampling-distribution-refresher">Sampling distribution refresher</a></li>
  <li><a href="#predicted-scores" id="toc-predicted-scores" class="nav-link" data-scroll-target="#predicted-scores">Predicted scores</a></li>
  <li><a href="#anova-as-regression" id="toc-anova-as-regression" class="nav-link" data-scroll-target="#anova-as-regression">ANOVA as regression</a></li>
  <li><a href="#anova-as-regression-1" id="toc-anova-as-regression-1" class="nav-link" data-scroll-target="#anova-as-regression-1">ANOVA as regression</a></li>
  <li><a href="#what-if-we-changed-0-and-1-to-other-values" id="toc-what-if-we-changed-0-and-1-to-other-values" class="nav-link" data-scroll-target="#what-if-we-changed-0-and-1-to-other-values">What if we changed 0 and 1 to other values?</a></li>
  <li><a href="#effect-coding" id="toc-effect-coding" class="nav-link" data-scroll-target="#effect-coding">Effect coding</a></li>
  <li><a href="#effect-coding-1" id="toc-effect-coding-1" class="nav-link" data-scroll-target="#effect-coding-1">Effect coding</a></li>
  <li><a href="#effect-coding-2" id="toc-effect-coding-2" class="nav-link" data-scroll-target="#effect-coding-2">Effect coding</a></li>
  <li><a href="#dummy-coding" id="toc-dummy-coding" class="nav-link" data-scroll-target="#dummy-coding">Dummy coding</a></li>
  <li><a href="#contrast-coding" id="toc-contrast-coding" class="nav-link" data-scroll-target="#contrast-coding">Contrast coding</a></li>
  <li><a href="#categorical-coding-summary" id="toc-categorical-coding-summary" class="nav-link" data-scroll-target="#categorical-coding-summary">categorical coding summary</a></li>
  <li><a href="#statistical-inference" id="toc-statistical-inference" class="nav-link" data-scroll-target="#statistical-inference">Statistical Inference</a></li>
  <li><a href="#predictions" id="toc-predictions" class="nav-link" data-scroll-target="#predictions">Predictions</a></li>
  <li><a href="#predictions-1" id="toc-predictions-1" class="nav-link" data-scroll-target="#predictions-1">Predictions</a></li>
  <li><a href="#which-one-has-better-fit" id="toc-which-one-has-better-fit" class="nav-link" data-scroll-target="#which-one-has-better-fit">Which one has better fit?</a></li>
  <li><a href="#easy-to-examine-fit-with-lm-objects" id="toc-easy-to-examine-fit-with-lm-objects" class="nav-link" data-scroll-target="#easy-to-examine-fit-with-lm-objects">Easy to examine fit with <code>lm</code> objects</a></li>
  <li><a href="#an-aside-concerning-lm-objects" id="toc-an-aside-concerning-lm-objects" class="nav-link" data-scroll-target="#an-aside-concerning-lm-objects">An aside concerning <code>lm</code> objects</a></li>
  <li><a href="#statistical-inference-1" id="toc-statistical-inference-1" class="nav-link" data-scroll-target="#statistical-inference-1">Statistical Inference</a></li>
  <li><a href="#partitioning-the-variation-in-y" id="toc-partitioning-the-variation-in-y" class="nav-link" data-scroll-target="#partitioning-the-variation-in-y">Partitioning the variation in Y</a></li>
  <li><a href="#what-can-we-do-with-this" id="toc-what-can-we-do-with-this" class="nav-link" data-scroll-target="#what-can-we-do-with-this">What can we do with this?</a></li>
  <li><a href="#coefficient-of-determination" id="toc-coefficient-of-determination" class="nav-link" data-scroll-target="#coefficient-of-determination">Coefficient of Determination</a></li>
  <li><a href="#r2-and-eta-squared" id="toc-r2-and-eta-squared" class="nav-link" data-scroll-target="#r2-and-eta-squared"><span class="math inline">\(R^2\)</span> and Eta squared</a></li>
  <li><a href="#r2-for-different-coding-schemes" id="toc-r2-for-different-coding-schemes" class="nav-link" data-scroll-target="#r2-for-different-coding-schemes"><span class="math inline">\(R^2\)</span> for different coding schemes</a></li>
  <li><a href="#note-the-r2-p-value" id="toc-note-the-r2-p-value" class="nav-link" data-scroll-target="#note-the-r2-p-value">Note the <span class="math inline">\(R^2\)</span> <em>p</em>-value</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  <li><a href="#summary-1" id="toc-summary-1" class="nav-link" data-scroll-target="#summary-1">Summary</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="2-Basics.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">GLM basics</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="thinking-in-terms-of-models" class="level2">
<h2 class="anchored" data-anchor-id="thinking-in-terms-of-models">Thinking in terms of models</h2>
<ul>
<li><p>Our DV (here forth Y) is what we are trying to understand</p></li>
<li><p>We hypothesize it has some relationship with your IV(s) (here forth Xs), with what is left over described as error (E)</p></li>
</ul>
<p><span class="math inline">\(y = b_0 + b_{1}X + e\)</span></p>
</section>
<section id="how-can-we-visualize-data-to-make-sense-of-it" class="level2">
<h2 class="anchored" data-anchor-id="how-can-we-visualize-data-to-make-sense-of-it">How can we visualize data to make sense of it?</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>x<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>e<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>y<span class="fl">.1</span> <span class="ot">&lt;-</span> .<span class="dv">5</span> <span class="sc">+</span> .<span class="dv">55</span> <span class="sc">*</span> x<span class="fl">.1</span> <span class="sc">+</span> e<span class="fl">.1</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>d<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x<span class="fl">.1</span>,y<span class="fl">.1</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>m<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="fl">.1</span> <span class="sc">~</span> x<span class="fl">.1</span>, <span class="at">data =</span> d<span class="fl">.1</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>d1.f<span class="ot">&lt;-</span> <span class="fu">augment</span>(m<span class="fl">.1</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>d<span class="fl">.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             x.1         y.1
1   -0.560475647 -1.22907473
2   -0.230177489  0.88716980
3    1.558708314  0.86390582
4    0.070508391 -0.15630558
5    0.129287735 -1.33212888
6    1.715064987  1.35323029
7    0.460916206 -0.81630503
8   -1.265061235 -3.53166755
9   -0.686852852 -0.63822211
10  -0.445661970  2.09287913
11   1.224081797  0.02255106
12   0.359813827  1.91382625
13   0.400771451 -2.51534112
14   0.110682716  0.44975156
15  -0.555841135  1.23310178
16   1.786913137  2.08510895
17   0.497850478  0.98517015
18  -1.966617157 -1.86305145
19   0.701355902 -0.81366295
20  -0.472791408 -1.80829286
21  -1.067823706  0.14799016
22  -0.217974915 -1.51483543
23  -1.026004448 -1.04541733
24  -0.728891229 -0.41307456
25  -0.625039268  3.84395241
26  -1.686693311 -1.73158112
27   0.837787044  1.43155602
28   0.153373118  0.74027691
29  -1.138136937 -2.04968858
30   1.253814921  1.04698203
31   0.426464221  3.62365704
32  -0.295071483  1.24071879
33   0.895125661  1.07478496
34   0.878133488  0.13797975
35   0.821581082 -3.15462485
36   0.688640254  3.14142657
37   0.553917654 -2.11662543
38  -0.061911711  1.94584358
39  -0.305962664  4.14992767
40  -0.380471001 -2.59704537
41  -0.694706979  1.52147983
42  -0.207917278 -0.13874948
43  -1.265396352 -3.34025631
44   2.168955965 -1.33640953
45   1.207961998 -2.03869325
46  -1.123108583 -1.17952277
47  -0.402884835 -2.64509783
48  -0.466655354  1.61917310
49   0.779965118  5.12919870
50  -0.083369066 -2.11991394
51   0.253318514  2.21480288
52  -0.028546755  2.02238377
53  -0.042870457  1.14082641
54   1.368602284 -0.76402196
55  -0.225770986  0.13692074
56   1.516470604  0.77326816
57  -1.548752804  0.77416502
58   0.584613750  0.07666005
59   0.123854244  2.52206661
60   0.215941569 -0.13039385
61   0.379639483  2.81422465
62  -0.502323453 -1.87463191
63  -0.333207384 -2.20357455
64  -1.018575383  6.42186341
65  -1.071791226 -0.92320035
66   0.303528641  1.26339594
67   0.448209779  2.01965473
68   0.053004227 -0.43840893
69   0.922267468  2.04097120
70   2.050084686  2.36547563
71  -0.491031166 -0.20082816
72  -2.309168876 -0.63945681
73   1.005738524  0.98502168
74  -0.709200763  4.36684338
75  -0.688008616 -1.36107693
76   1.025571370 -1.12792828
77  -0.284773007  0.41895164
78  -1.220717712  0.44956676
79   0.181303480  1.47276387
80  -0.138891362 -0.49312091
81   0.005764186 -1.62348197
82   0.385280401  3.23827457
83  -0.370660032 -0.40316379
84   0.644376549 -0.87661862
85  -0.220486562 -0.09382675
86   0.331781964  0.28812829
87   1.096839013  3.32310204
88   0.435181491  0.90882440
89  -0.325931586  1.82884520
90   1.148807618  0.13326016
91   0.993503856  1.47531774
92   0.548396960  0.15224650
93   0.238731735  0.82046951
94  -0.627906076 -1.63607506
95   1.360652449 -1.37324422
96  -0.600259587  4.16428400
97   2.187332993  2.90445079
98   1.532610626 -1.15960688
99  -0.235700359 -0.85196703
100 -1.026420900 -2.43549166</code></pre>
</div>
</div>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.4.3     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d1.f , <span class="fu">aes</span>(<span class="at">x=</span>x<span class="fl">.1</span>, <span class="at">y=</span>y<span class="fl">.1</span>)) <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="2-Basics_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d1.f , <span class="fu">aes</span>(<span class="at">x=</span>x<span class="fl">.1</span>, <span class="at">y=</span>y<span class="fl">.1</span>)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">FALSE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="2-Basics_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="how-do-we-visualize-categorical-data" class="level2">
<h2 class="anchored" data-anchor-id="how-do-we-visualize-categorical-data">How do we visualize categorical data?</h2>
<p>Nominal/categorical data does not have any inherent numbers associated with it. Think control/tx, eye color, etc.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>x<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">rep</span>(group, <span class="at">times =</span> <span class="dv">50</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>e<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>y<span class="fl">.1</span> <span class="ot">&lt;-</span> .<span class="dv">5</span> <span class="sc">+</span> .<span class="dv">85</span> <span class="sc">*</span> x<span class="fl">.2</span> <span class="sc">+</span> e<span class="fl">.1</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>d<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x<span class="fl">.2</span>,y<span class="fl">.1</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>m<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="fl">.1</span> <span class="sc">~</span> x<span class="fl">.2</span>, <span class="at">data =</span> d<span class="fl">.2</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>d2.f<span class="ot">&lt;-</span> <span class="fu">augment</span>(m<span class="fl">.2</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>d<span class="fl">.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    x.2          y.1
1     0 -0.060475647
2     1  1.119822511
3     0  2.058708314
4     1  1.420508391
5     0  0.629287735
6     1  3.065064987
7     0  0.960916206
8     1  0.084938765
9     0 -0.186852852
10    1  0.904338030
11    0  1.724081797
12    1  1.709813827
13    0  0.900771451
14    1  1.460682716
15    0 -0.055841135
16    1  3.136913137
17    0  0.997850478
18    1 -0.616617157
19    0  1.201355902
20    1  0.877208592
21    0 -0.567823706
22    1  1.132025085
23    0 -0.526004448
24    1  0.621108771
25    0 -0.125039268
26    1 -0.336693311
27    0  1.337787044
28    1  1.503373118
29    0 -0.638136937
30    1  2.603814921
31    0  0.926464221
32    1  1.054928517
33    0  1.395125661
34    1  2.228133488
35    0  1.321581082
36    1  2.038640254
37    0  1.053917654
38    1  1.288088289
39    0  0.194037336
40    1  0.969528999
41    0 -0.194706979
42    1  1.142082722
43    0 -0.765396352
44    1  3.518955965
45    0  1.707961998
46    1  0.226891417
47    0  0.097115165
48    1  0.883344646
49    0  1.279965118
50    1  1.266630934
51    0  0.753318514
52    1  1.321453245
53    0  0.457129543
54    1  2.718602284
55    0  0.274229014
56    1  2.866470604
57    0 -1.048752804
58    1  1.934613750
59    0  0.623854244
60    1  1.565941569
61    0  0.879639483
62    1  0.847676547
63    0  0.166792616
64    1  0.331424617
65    0 -0.571791226
66    1  1.653528641
67    0  0.948209779
68    1  1.403004227
69    0  1.422267468
70    1  3.400084686
71    0  0.008968834
72    1 -0.959168876
73    0  1.505738524
74    1  0.640799237
75    0 -0.188008616
76    1  2.375571370
77    0  0.215226993
78    1  0.129282288
79    0  0.681303480
80    1  1.211108638
81    0  0.505764186
82    1  1.735280401
83    0  0.129339968
84    1  1.994376549
85    0  0.279513438
86    1  1.681781964
87    0  1.596839013
88    1  1.785181491
89    0  0.174068414
90    1  2.498807618
91    0  1.493503856
92    1  1.898396960
93    0  0.738731735
94    1  0.722093924
95    0  1.860652449
96    1  0.749740413
97    0  2.687332993
98    1  2.882610626
99    0  0.264299641
100   1  0.323579100</code></pre>
</div>
</div>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d2.f , <span class="fu">aes</span>(<span class="at">x=</span>x<span class="fl">.2</span>, <span class="at">y=</span>y<span class="fl">.1</span>)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">FALSE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="2-Basics_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d2.f,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(x<span class="fl">.2</span>),</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> y<span class="fl">.1</span>)) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(x<span class="fl">.2</span>)),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> .<span class="dv">3</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">as.factor</span>(x<span class="fl">.2</span>)),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="st">"white"</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">as.factor</span>(x<span class="fl">.2</span>))) <span class="sc">+</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Treatment"</span>,</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="2-Basics_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="what-do-these-visualizations-have-in-common" class="level2">
<h2 class="anchored" data-anchor-id="what-do-these-visualizations-have-in-common">What do these visualizations have in common?</h2>
<p>. . .</p>
<p>LINES!</p>
<p>Most of what we are going to do is represent the relationship between variables with lines (or planes or hyperplanes once we get into 2 or more variables)</p>
</section>
<section id="thinking-in-terms-of-models-1" class="level2">
<h2 class="anchored" data-anchor-id="thinking-in-terms-of-models-1">Thinking in terms of models</h2>
<ul>
<li><p>Models help us draw the lines</p></li>
<li><p>Our DV (here forth Y) is what we are trying to understand</p></li>
<li><p>We hypothesize it has some relationship with your IV(s) (hence forth Xs), with what is left over described as error (E)</p></li>
</ul>
<p><span class="math inline">\(y = b_0 + b_{1}X + e\)</span></p>
<ul>
<li><span class="math inline">\(b_{1}\)</span> describes the strength of association i.e.&nbsp;the line!</li>
</ul>
</section>
<section id="see-this-in-our-r-code" class="level2">
<h2 class="anchored" data-anchor-id="see-this-in-our-r-code">See this in our R code</h2>
<p>Independent samples t-test</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>t<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">t.test</span>(y<span class="fl">.1</span> <span class="sc">~</span> x<span class="fl">.2</span>, <span class="at">data =</span> d<span class="fl">.2</span>) </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>t<span class="fl">.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  y.1 by x.2
t = -4.4144, df = 93.846, p-value = 2.706e-05
alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
95 percent confidence interval:
 -1.1740658 -0.4455722
sample estimates:
mean in group 0 mean in group 1 
      0.6104964       1.4203154 </code></pre>
</div>
</div>
<hr>
<p>One-way ANOVA</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>a<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">aov</span>(y<span class="fl">.1</span> <span class="sc">~</span> x<span class="fl">.2</span>, <span class="at">data=</span>d<span class="fl">.2</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(a<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
x.2          1  16.40  16.395   19.49 2.61e-05 ***
Residuals   98  82.45   0.841                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<hr>
<p>regression model</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="fl">.1</span> <span class="sc">~</span> x<span class="fl">.2</span>, <span class="at">data=</span>d<span class="fl">.2</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y.1 ~ x.2, data = d.2)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.37948 -0.57986 -0.00856  0.59773  2.09864 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.6105     0.1297   4.706 8.29e-06 ***
x.2           0.8098     0.1834   4.414 2.61e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9172 on 98 degrees of freedom
Multiple R-squared:  0.1659,    Adjusted R-squared:  0.1574 
F-statistic: 19.49 on 1 and 98 DF,  p-value: 2.607e-05</code></pre>
</div>
</div>
</section>
<section id="comparison-across-these-three-models" class="level2">
<h2 class="anchored" data-anchor-id="comparison-across-these-three-models">Comparison across these three models</h2>
<ul>
<li><p>Note that each of these three models (t, anova, regression) were exactly the same in terms of the mode: Y ~ X</p></li>
<li><p>That is because they are the same model! Different terms referring to the same thing is one of the major stumbling blocks of stats.</p></li>
<li><p>Yet they gave us different information. Depending on what you are interested in some information may be more pertinent.</p></li>
<li><p>We will focus on the regression model (glm) as it is most flexible</p></li>
</ul>
</section>
<section id="general-linear-model-glm" class="level2">
<h2 class="anchored" data-anchor-id="general-linear-model-glm">General linear model (GLM)</h2>
<ul>
<li><p>This model (equation) can be very simple as in a treatment/control experiment</p></li>
<li><p>It can be very complex in terms of trying to understand something like academic achievement</p></li>
<li><p>The majority of our models fall under the umbrella of a general(ized) linear model (often referred to as regression models)</p></li>
<li><p>Models imply our theory about how the data are generated (ie how the world works)</p></li>
</ul>
</section>
<section id="regression-equation" class="level2">
<h2 class="anchored" data-anchor-id="regression-equation">Regression Equation</h2>
<p><span class="math display">\[Y_i = b_{0} + b_{1}X_i +e_i\]</span></p>
<ul>
<li><p><span class="math inline">\(Y_i \sim Normal(\mu, \sigma)\)</span></p></li>
<li><p>The DV, <span class="math inline">\(Y\)</span> for each person <span class="math inline">\(i\)</span> is distributed normaly, with a mean of <span class="math inline">\(\mu\)</span> and a standard deviation of <span class="math inline">\(\sigma\)</span></p></li>
</ul>
</section>
<section id="regression-terms" class="level2">
<h2 class="anchored" data-anchor-id="regression-terms">Regression terms</h2>
<ul>
<li>Y / DV / Outcome / Response / Criterion</li>
<li>X / IV / Predictor / Explanatory variable</li>
<li>Regression coefficient (weight) / b / b* / <span class="math inline">\(\beta\)</span></li>
<li>Intercept <span class="math inline">\(b_0\)</span> / <span class="math inline">\(\beta_{0}\)</span></li>
<li>Error / Residuals <span class="math inline">\(e\)</span></li>
<li>Predictions <span class="math inline">\(\hat{Y}\)</span></li>
</ul>
</section>
<section id="regression-models" class="level2">
<h2 class="anchored" data-anchor-id="regression-models">Regression models</h2>
<ul>
<li><p>These models are a way to convey the relationship between two (or more) variables. They translate our hypotheses into math.</p></li>
<li><p>We can use these models to get information we may be interested in (e.g.&nbsp;means, SEs) and test hypotheses about the relationship among variables</p></li>
<li><p><em>“All models are wrong but some are useful (and some are better than others)”</em> - George Box</p></li>
</ul>
</section>
<section id="another-example" class="level2">
<h2 class="anchored" data-anchor-id="another-example">Another example</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>example.data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"exampleData.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 280 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (3): id, tx, traffic.risk

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>example.data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(example.data)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>example.data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 270 × 3
      id    tx traffic.risk
   &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;
 1     1     1         1.86
 2     2     1         1   
 3     3     1         3.29
 4     4     1         2   
 5     5     1         2.43
 6     6     1         3.29
 7     7     0         1.17
 8     8     0         2.43
 9     9     0         3   
10    10     1         1.71
# ℹ 260 more rows</code></pre>
</div>
</div>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(example.data,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(tx),</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> traffic.risk)) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(tx)),</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> .<span class="dv">3</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">as.factor</span>(tx)),</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="st">"white"</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">as.factor</span>(tx))) <span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Treatment"</span>,</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Traffic Risk"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="2-Basics_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(traffic.risk <span class="sc">~</span> tx, <span class="at">data =</span> example.data, </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">var.equal =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  traffic.risk by tx
t = 4.9394, df = 268, p-value = 1.381e-06
alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
95 percent confidence interval:
 0.2893360 0.6728755
sample estimates:
mean in group 0 mean in group 1 
       2.650641        2.169535 </code></pre>
</div>
</div>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>a<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">aov</span>(traffic.risk <span class="sc">~</span> tx, <span class="at">data =</span> example.data) </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(a<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
tx            1   14.8  14.800    24.4 1.38e-06 ***
Residuals   268  162.6   0.607                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>mod<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(traffic.risk <span class="sc">~</span> tx, <span class="at">data =</span> example.data)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = traffic.risk ~ tx, data = example.data)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.65064 -0.59811 -0.02668  0.54475  2.54475 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.65064    0.07637  34.707  &lt; 2e-16 ***
tx          -0.48111    0.09740  -4.939 1.38e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7789 on 268 degrees of freedom
Multiple R-squared:  0.08344,   Adjusted R-squared:  0.08002 
F-statistic:  24.4 on 1 and 268 DF,  p-value: 1.381e-06</code></pre>
</div>
</div>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>mod<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(traffic.risk <span class="sc">~</span> tx, <span class="at">data =</span> example.data)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: traffic.risk
           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
tx          1  14.80 14.7999  24.398 1.381e-06 ***
Residuals 268 162.57  0.6066                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="example-summary" class="level2">
<h2 class="anchored" data-anchor-id="example-summary">Example summary</h2>
<ul>
<li><p>Same <em>p</em>-values for each test; same SS; same test!</p></li>
<li><p>t-test is a special form of a linear model</p></li>
<li><p>anova is a special form of a linear model</p></li>
<li><p>Because the anova and t-test are narrower models, we will be working with the <em>general</em> linear model</p></li>
</ul>
</section>
<section id="parts-of-the-model" class="level2">
<h2 class="anchored" data-anchor-id="parts-of-the-model">Parts of the model</h2>
<p><span class="math display">\[Y_i = b_{0} + b_{1}X_i + e_i\]</span> <span class="math display">\[T.risk_i = b_{0} + b_{1}TX_i + e_i\]</span></p>
<ul>
<li>Each individual has a unique Y value an X value and a residual/error term<br>
</li>
<li>The model only has a single <span class="math inline">\(b_{0}\)</span> and <span class="math inline">\(b_{1}\)</span> term. These are the regression parameters. <span class="math inline">\(b_{0}\)</span> is the intercept and <span class="math inline">\(b_{1}\)</span> quantifies the relationship between your model of the world and the DV.</li>
</ul>
</section>
<section id="what-do-the-estimates-tell-us" class="level2">
<h2 class="anchored" data-anchor-id="what-do-the-estimates-tell-us">What do the estimates tell us?</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>mod<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(traffic.risk <span class="sc">~</span> tx, <span class="at">data =</span> example.data)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(mod<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic   p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)    2.65     0.0764     34.7  3.80e-101
2 tx            -0.481    0.0974     -4.94 1.38e-  6</code></pre>
</div>
</div>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>example.data <span class="sc">%&gt;%</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(tx) <span class="sc">%&gt;%</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">mean</span>(traffic.risk))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
     tx `mean(traffic.risk)`
  &lt;dbl&gt;                &lt;dbl&gt;
1     0                 2.65
2     1                 2.17</code></pre>
</div>
</div>
</section>
<section id="how-to-interpret-regression-estimates" class="level2">
<h2 class="anchored" data-anchor-id="how-to-interpret-regression-estimates">How to interpret regression estimates</h2>
<ul>
<li>Intercept is the mean of group of variable tx that is coded 0</li>
<li>Regression coefficient is the slope or rise over run, scaled as a 1 unit on the x axis</li>
<li><strong>“For a one unit change in X, there is a b1 predicted change in Y.”</strong></li>
<li>Regression coefficient is the difference in means between the groups, given that we coded our groups as 0 and 1.</li>
</ul>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>You can cite this package as:
     Patil, I. (2021). Visualizations with statistical details: The 'ggstatsplot' approach.
     Journal of Open Source Software, 6(61), 3167, doi:10.21105/joss.03167</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>ggstatsplot<span class="sc">::</span><span class="fu">ggbetweenstats</span>(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> example.data,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> tx,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> traffic.risk,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Traffic Risk Score"</span>, <span class="co"># label for the y-axis variable</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Treatment group"</span>, <span class="co"># label for the x-axis variable</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">bf.message =</span> <span class="cn">FALSE</span>, </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">messages =</span> <span class="cn">FALSE</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="2-Basics_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
<p>Note that the same interpretation for a regression line holds: for a 1 unit change in X (tx) there is a predicted b change in Y (traffic risk)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(example.data, <span class="fu">aes</span>(<span class="at">x=</span>tx, <span class="at">y=</span>traffic.risk)) <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span>    </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm,   <span class="co"># Add linear regression line</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">se=</span><span class="cn">FALSE</span>)    <span class="co"># Don't add shaded confidence region</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="2-Basics_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="how-to-interpret-regression-estimates-1" class="level2">
<h2 class="anchored" data-anchor-id="how-to-interpret-regression-estimates-1">How to interpret regression estimates</h2>
<ul>
<li><p>The entire class will go over different ways to interpret these estimates/parameters/coefficients</p></li>
<li><p>Intercept (b0) signifies the level of Y when your model IVs (Xs) are zero</p></li>
<li><p>Regression (b1) signifies the difference for a one unit change in your X</p></li>
</ul>
</section>
<section id="standard-errors" class="level2">
<h2 class="anchored" data-anchor-id="standard-errors">Standard errors</h2>
<ul>
<li><p>These coefficients are “best guesses” at some population parameter we want to make inferences about.</p></li>
<li><p>To do so we must balance our signal to our noise. If we have a strong signal (steep regression line/difference between groups) that would imply the groups differ.</p></li>
<li><p>If there was a lot of noise in that assessment then a big difference between groups may not be meaningful. We assess this “noise” component with our standard errors</p></li>
</ul>
</section>
<section id="sampling-distribution-refresher" class="level2">
<h2 class="anchored" data-anchor-id="sampling-distribution-refresher">Sampling distribution refresher</h2>
<ul>
<li>We collect a sample and calculate a sample statistic <span class="math inline">\(b_1\)</span></li>
<li>This statistic is not a perfect assessment of the population</li>
<li>We calculate a sampling distribution to represent all possible samples we could have gotten from the same population with the same sample size</li>
<li>The standard deviation of the sampling distribution (standard error) reflects the spread of the hypothetical scores <em>we could have gotten</em></li>
<li>A large standard error means we have a flat sampling distribution and thus should not trust the estimate.</li>
<li>Per convention, if our estimate is &gt; 2xSE away from 0, we say our estimate is “significantly different from zero”</li>
</ul>
</section>
<section id="predicted-scores" class="level2">
<h2 class="anchored" data-anchor-id="predicted-scores">Predicted scores</h2>
<ul>
<li>Based on the output how do I calculate means for each group?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(mod<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic   p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)    2.65     0.0764     34.7  3.80e-101
2 tx            -0.481    0.0974     -4.94 1.38e-  6</code></pre>
</div>
</div>
</section>
<section id="anova-as-regression" class="level2">
<h2 class="anchored" data-anchor-id="anova-as-regression">ANOVA as regression</h2>
<ul>
<li>“For a one unit change in X, there is a b1 predicted change in Y” will always be true.</li>
<li>Nominal/categorical variables do not have any inherent numbers associated with them so we need to assign them numbers</li>
<li>What numbers you assign will impact the equation/estimates/hypothesis you can test<br>
</li>
<li>Behoove you to code them as useful numbers. O and 1 are useful and are the default in R.</li>
</ul>
</section>
<section id="anova-as-regression-1" class="level2">
<h2 class="anchored" data-anchor-id="anova-as-regression-1">ANOVA as regression</h2>
<p><span class="math display">\[T.risk_i = b_{0} + b_{1}TX_i + e_i\]</span></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>example.data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 270 × 3
      id    tx traffic.risk
   &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;
 1     1     1         1.86
 2     2     1         1   
 3     3     1         3.29
 4     4     1         2   
 5     5     1         2.43
 6     6     1         3.29
 7     7     0         1.17
 8     8     0         2.43
 9     9     0         3   
10    10     1         1.71
# ℹ 260 more rows</code></pre>
</div>
</div>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>example.data<span class="sc">$</span>tx.r <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(example.data<span class="sc">$</span>tx)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>example.data<span class="sc">$</span>tx.r <span class="ot">&lt;-</span> <span class="fu">recode_factor</span>(example.data<span class="sc">$</span>tx.r, <span class="st">"0"</span> <span class="ot">=</span> <span class="st">"control"</span>, <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"treatment"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Create a new variable that is not numeric</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>example.data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 270 × 4
      id    tx traffic.risk tx.r     
   &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt; &lt;fct&gt;    
 1     1     1         1.86 treatment
 2     2     1         1    treatment
 3     3     1         3.29 treatment
 4     4     1         2    treatment
 5     5     1         2.43 treatment
 6     6     1         3.29 treatment
 7     7     0         1.17 control  
 8     8     0         2.43 control  
 9     9     0         3    control  
10    10     1         1.71 treatment
# ℹ 260 more rows</code></pre>
</div>
</div>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>mod<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(traffic.risk <span class="sc">~</span> tx, <span class="at">data =</span> example.data)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(mod<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic   p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)    2.65     0.0764     34.7  3.80e-101
2 tx            -0.481    0.0974     -4.94 1.38e-  6</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>mod<span class="fl">.1</span>r <span class="ot">&lt;-</span> <span class="fu">lm</span>(traffic.risk <span class="sc">~</span> tx.r, <span class="at">data =</span> example.data)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(mod<span class="fl">.1</span>r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term          estimate std.error statistic   p.value
  &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)      2.65     0.0764     34.7  3.80e-101
2 tx.rtreatment   -0.481    0.0974     -4.94 1.38e-  6</code></pre>
</div>
</div>
</section>
<section id="what-if-we-changed-0-and-1-to-other-values" class="level2">
<h2 class="anchored" data-anchor-id="what-if-we-changed-0-and-1-to-other-values">What if we changed 0 and 1 to other values?</h2>
<ul>
<li>Infinite number of ways to code categorical/nominal variables, only a few meaningful ways<br>
</li>
<li>The R default is called “dummy coding”<br>
</li>
<li>Uses 0s and 1s to put numbers to categories. We will soon see what this looks like when you have more than 2 groups.</li>
<li>Changing the numbers changes…?</li>
</ul>
</section>
<section id="effect-coding" class="level2">
<h2 class="anchored" data-anchor-id="effect-coding">Effect coding</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>example.data<span class="sc">$</span>tx.effect <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(example.data<span class="sc">$</span>tx, <span class="st">'0'</span> <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span>, <span class="st">'1'</span> <span class="ot">=</span> <span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>example.data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 270 × 5
      id    tx traffic.risk tx.r      tx.effect
   &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt; &lt;fct&gt;         &lt;dbl&gt;
 1     1     1         1.86 treatment         1
 2     2     1         1    treatment         1
 3     3     1         3.29 treatment         1
 4     4     1         2    treatment         1
 5     5     1         2.43 treatment         1
 6     6     1         3.29 treatment         1
 7     7     0         1.17 control          -1
 8     8     0         2.43 control          -1
 9     9     0         3    control          -1
10    10     1         1.71 treatment         1
# ℹ 260 more rows</code></pre>
</div>
</div>
</section>
<section id="effect-coding-1" class="level2">
<h2 class="anchored" data-anchor-id="effect-coding-1">Effect coding</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>mod.<span class="fl">1.</span>eff <span class="ot">&lt;-</span> <span class="fu">lm</span>(traffic.risk <span class="sc">~</span> tx.effect, <span class="at">data =</span> example.data)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(mod.<span class="fl">1.</span>eff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic   p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)    2.41     0.0487     49.5  8.15e-137
2 tx.effect     -0.241    0.0487     -4.94 1.38e-  6</code></pre>
</div>
</div>
<ul>
<li>systematically changes both the intercept and the regression estimate</li>
</ul>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>effect <span class="ot">&lt;-</span> <span class="fu">tidy</span>(mod.<span class="fl">1.</span>eff)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>effect</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic   p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)    2.41     0.0487     49.5  8.15e-137
2 tx.effect     -0.241    0.0487     -4.94 1.38e-  6</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>dummy <span class="ot">&lt;-</span> <span class="fu">tidy</span>(mod<span class="fl">.1</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>dummy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic   p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)    2.65     0.0764     34.7  3.80e-101
2 tx            -0.481    0.0974     -4.94 1.38e-  6</code></pre>
</div>
</div>
<ul>
<li><p>Intercept: value when your predictor X is zero</p></li>
<li><p>Regression coefficient: one unit increase in X is associated with a (regression estimate) predicted increase in Y</p></li>
</ul>
</section>
<section id="effect-coding-2" class="level2">
<h2 class="anchored" data-anchor-id="effect-coding-2">Effect coding</h2>
<p>Consists of -1, 1s (And zeros for more than 2 groups)</p>
<ol type="1">
<li>The intercept is the “grand mean” or “mean of means” if unbalanced</li>
<li>The regression coefficient represents the group “effect” ie the difference between the grand mean and the group labeled 1 (we will revisit this when we have more than 2 groups as it will make more sense)</li>
</ol>
<ul>
<li>Common to use for Factorial ANOVA designs</li>
</ul>
</section>
<section id="dummy-coding" class="level2">
<h2 class="anchored" data-anchor-id="dummy-coding">Dummy coding</h2>
<ul>
<li><p>More appropriate when you are interested in comparing to a specific group rather than an “average person.”</p></li>
<li><p>Intercept: value of the group coded zero</p></li>
<li><p>Regression coefficient: mean difference between groups</p></li>
</ul>
</section>
<section id="contrast-coding" class="level2">
<h2 class="anchored" data-anchor-id="contrast-coding">Contrast coding</h2>
<ul>
<li>As our models get more complex our coding schemes can too</li>
<li>What happens if you code the groups -.5 and .5?</li>
<li>These make more sense when we have more groups. More groups require more independent variables, however.</li>
</ul>
</section>
<section id="categorical-coding-summary" class="level2">
<h2 class="anchored" data-anchor-id="categorical-coding-summary">categorical coding summary</h2>
<ul>
<li><p>In the end, it really doesn’t matter how you code your model. The overall “fit” of the model will be exactly the same because it is the same model.</p></li>
<li><p>The only thing that changes is the interpretation of your coefficients.</p></li>
<li><p>Even then, you can recreate any test you want regardless of coding scheme. As a result, we often leave the default coding in place.</p></li>
</ul>
</section>
<section id="statistical-inference" class="level2">
<h2 class="anchored" data-anchor-id="statistical-inference">Statistical Inference</h2>
<ul>
<li>The way the world is = our model + error</li>
<li>How good is our model? Is it a good representation of reality? Does it “fit” the data well?</li>
<li>Need to go beyond asking if it is significant, because what does that mean? Remember, all models are wrong</li>
<li>We are going to make predictions and see if the predictions (based on our model) matches our data</li>
<li>We can then compare one model to another to see which one matches our data better ie which one is a better representation of reality.</li>
</ul>
</section>
<section id="predictions" class="level2">
<h2 class="anchored" data-anchor-id="predictions">Predictions</h2>
<ul>
<li>Our model is a prediction machine.</li>
<li>They are created by simply plugging a persons Xs into the created model</li>
<li>If you have bs and have Xs you can create a prediction</li>
</ul>
<p><span class="math inline">\(\hat{Y}_{i}\)</span> = 2.65064 + -0.48111* <span class="math inline">\(X_{i}\)</span></p>
</section>
<section id="predictions-1" class="level2">
<h2 class="anchored" data-anchor-id="predictions-1">Predictions</h2>
<ul>
<li>We want our predictions to be close to our actual data for each person ( <span class="math inline">\(Y_{i}\)</span> )</li>
<li>The difference between the actual data and our our prediction ( <span class="math inline">\(Y_{i} - \hat{Y}_{i} = e\)</span> ) is the residual, how far we are “off”. This tells us how good our fit is.</li>
<li>You can have the same estimates for two models but completely different fit.</li>
<li>Previously you may have evaluated overall model fit by looking at Eta Squared, SS Error and visualizing observations around group means</li>
</ul>
</section>
<section id="which-one-has-better-fit" class="level2">
<h2 class="anchored" data-anchor-id="which-one-has-better-fit">Which one has better fit?</h2>
<ul>
<li>Can you point out the predictions?</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>twogroup_fun <span class="ot">=</span> <span class="cf">function</span>(<span class="at">nrep =</span> <span class="dv">100</span>, <span class="at">b0 =</span> <span class="dv">6</span>, <span class="at">b1 =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">sigma =</span> <span class="dv">1</span>) {</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>     ngroup <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>     group <span class="ot">=</span> <span class="fu">rep</span>( <span class="fu">c</span>(<span class="st">"group1"</span>, <span class="st">"group2"</span>), <span class="at">each =</span> nrep)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>     eps <span class="ot">=</span> <span class="fu">rnorm</span>(ngroup<span class="sc">*</span>nrep, <span class="dv">0</span>, sigma)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>     traffic <span class="ot">=</span> b0 <span class="sc">+</span> b1<span class="sc">*</span>(group <span class="sc">==</span> <span class="st">"group2"</span>) <span class="sc">+</span> eps</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>     growthfit <span class="ot">=</span> <span class="fu">lm</span>(traffic <span class="sc">~</span> group)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>     growthfit</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>twogroup_fun2 <span class="ot">=</span> <span class="cf">function</span>(<span class="at">nrep =</span> <span class="dv">100</span>, <span class="at">b0 =</span> <span class="dv">6</span>, <span class="at">b1 =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">sigma =</span> <span class="dv">2</span>) {</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>     ngroup <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>     group <span class="ot">=</span> <span class="fu">rep</span>( <span class="fu">c</span>(<span class="st">"group1"</span>, <span class="st">"group2"</span>), <span class="at">each =</span> nrep)</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>     eps <span class="ot">=</span> <span class="fu">rnorm</span>(ngroup<span class="sc">*</span>nrep, <span class="dv">0</span>, sigma)</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>     traffic <span class="ot">=</span> b0 <span class="sc">+</span> b1<span class="sc">*</span>(group <span class="sc">==</span> <span class="st">"group2"</span>) <span class="sc">+</span> eps</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>     growthfit <span class="ot">=</span> <span class="fu">lm</span>(traffic <span class="sc">~</span> group)</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>     growthfit</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">16</span>)</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">augment</span>(<span class="fu">twogroup_fun</span>())</span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">16</span>)</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>lm2 <span class="ot">&lt;-</span> <span class="fu">augment</span>(<span class="fu">twogroup_fun2</span>())</span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(lm1) <span class="sc">+</span></span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> traffic) <span class="sc">+</span></span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">geom_jitter</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">11</span>)</span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>plot2<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(lm2) <span class="sc">+</span></span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> traffic) <span class="sc">+</span></span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">geom_jitter</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">11</span>)</span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-36"><a href="#cb61-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gridExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">grid.arrange</span>(plot1, plot2, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing non-finite values (`stat_ydensity()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="2-Basics_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="easy-to-examine-fit-with-lm-objects" class="level2">
<h2 class="anchored" data-anchor-id="easy-to-examine-fit-with-lm-objects">Easy to examine fit with <code>lm</code> objects</h2>
<ul>
<li>These are automatically created anytime you run a <code>lm</code> in R</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>mod<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(traffic.risk <span class="sc">~</span> tx, <span class="at">data =</span> example.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coefficients</span>(mod<span class="fl">.1</span>)       <span class="co"># coefficients</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(mod<span class="fl">.1</span>)          <span class="co"># residuals</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted.values</span>(mod<span class="fl">.1</span>)      <span class="co"># fitted values ie predicted</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod<span class="fl">.1</span>)<span class="sc">$</span>r.squared  <span class="co"># R-sq for the model</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod<span class="fl">.1</span>)<span class="sc">$</span>sigma      <span class="co"># sd of residuals</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coefficients</span>(mod<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          tx 
  2.6506410  -0.4811057 </code></pre>
</div>
</div>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted.values</span>(mod<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2        3        4        5        6        7        8 
2.169535 2.169535 2.169535 2.169535 2.169535 2.169535 2.650641 2.650641 
       9       10       11       12       13       14       15       16 
2.650641 2.169535 2.169535 2.650641 2.650641 2.650641 2.650641 2.650641 
      17       18       19       20       21       22       23       24 
2.650641 2.650641 2.650641 2.169535 2.169535 2.169535 2.169535 2.169535 
      25       26       27       28       29       30       31       32 
2.650641 2.650641 2.650641 2.650641 2.650641 2.650641 2.650641 2.650641 
      33       34       35       36       37       38       39       40 
2.650641 2.650641 2.650641 2.650641 2.169535 2.169535 2.169535 2.169535 
      41       42       43       44       45       46       47       48 
2.650641 2.169535 2.650641 2.650641 2.169535 2.650641 2.650641 2.650641 
      49       50       51       52       53       54       55       56 
2.169535 2.650641 2.169535 2.169535 2.169535 2.169535 2.169535 2.650641 
      57       58       59       60       61       62       63       64 
2.169535 2.169535 2.169535 2.169535 2.650641 2.169535 2.169535 2.650641 
      65       66       67       68       69       70       71       72 
2.169535 2.169535 2.650641 2.650641 2.169535 2.169535 2.169535 2.169535 
      73       74       75       76       77       78       79       80 
2.169535 2.169535 2.169535 2.169535 2.650641 2.169535 2.169535 2.650641 
      81       82       83       84       85       86       87       88 
2.169535 2.650641 2.650641 2.650641 2.650641 2.169535 2.169535 2.650641 
      89       90       91       92       93       94       95       96 
2.169535 2.169535 2.169535 2.650641 2.169535 2.169535 2.169535 2.169535 
      97       98       99      100      101      102      103      104 
2.169535 2.169535 2.169535 2.169535 2.169535 2.169535 2.169535 2.169535 
     105      106      107      108      109      110      111      112 
2.650641 2.650641 2.650641 2.650641 2.650641 2.650641 2.650641 2.650641 
     113      114      115      116      117      118      119      120 
2.650641 2.650641 2.650641 2.650641 2.650641 2.650641 2.169535 2.650641 
     121      122      123      124      125      126      127      128 
2.650641 2.650641 2.650641 2.169535 2.169535 2.169535 2.169535 2.169535 
     129      130      131      132      133      134      135      136 
2.650641 2.169535 2.169535 2.169535 2.169535 2.169535 2.169535 2.169535 
     137      138      139      140      141      142      143      144 
2.169535 2.169535 2.169535 2.169535 2.169535 2.169535 2.169535 2.169535 
     145      146      147      148      149      150      151      152 
2.169535 2.169535 2.169535 2.169535 2.650641 2.650641 2.650641 2.650641 
     153      154      155      156      157      158      159      160 
2.650641 2.650641 2.169535 2.650641 2.169535 2.169535 2.169535 2.169535 
     161      162      163      164      165      166      167      168 
2.650641 2.169535 2.169535 2.169535 2.169535 2.169535 2.169535 2.169535 
     169      170      171      172      173      174      175      176 
2.169535 2.169535 2.650641 2.650641 2.169535 2.169535 2.169535 2.650641 
     177      178      179      180      181      182      183      184 
2.650641 2.650641 2.169535 2.169535 2.169535 2.169535 2.169535 2.650641 
     185      186      187      188      189      190      191      192 
2.169535 2.169535 2.169535 2.169535 2.169535 2.650641 2.169535 2.169535 
     193      194      195      196      197      198      199      200 
2.169535 2.650641 2.169535 2.169535 2.650641 2.169535 2.169535 2.169535 
     201      202      203      204      205      206      207      208 
2.169535 2.650641 2.169535 2.169535 2.169535 2.169535 2.169535 2.169535 
     209      210      211      212      213      214      215      216 
2.169535 2.169535 2.169535 2.169535 2.169535 2.650641 2.650641 2.169535 
     217      218      219      220      221      222      223      224 
2.169535 2.169535 2.169535 2.169535 2.169535 2.169535 2.650641 2.169535 
     225      226      227      228      229      230      231      232 
2.169535 2.169535 2.169535 2.650641 2.169535 2.169535 2.650641 2.169535 
     233      234      235      236      237      238      239      240 
2.169535 2.650641 2.169535 2.169535 2.169535 2.169535 2.169535 2.650641 
     241      242      243      244      245      246      247      248 
2.650641 2.169535 2.650641 2.169535 2.169535 2.169535 2.169535 2.650641 
     249      250      251      252      253      254      255      256 
2.650641 2.650641 2.169535 2.650641 2.650641 2.169535 2.169535 2.169535 
     257      258      259      260      261      262      263      264 
2.169535 2.169535 2.650641 2.169535 2.169535 2.650641 2.650641 2.650641 
     265      266      267      268      269      270 
2.650641 2.650641 2.650641 2.650641 2.650641 2.650641 </code></pre>
</div>
</div>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(mod<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           1            2            3            4            5            6 
-0.312392427 -1.169535284  1.116179002 -0.169535284  0.259036145  1.116179002 
           7            8            9           10           11           12 
-1.483974359 -0.222069597  0.349358974 -0.455249570  1.687607573 -0.079212455 
          13           14           15           16           17           18 
 0.206501831  0.920787545  1.349358974  0.349358974 -0.936355312 -1.364926740 
          19           20           21           22           23           24 
-0.364926740 -0.312392427 -0.598106713 -0.026678141  0.116179002 -0.455249570 
          25           26           27           28           29           30 
 1.063644688 -0.650641026 -0.079212455  0.206501831  0.777930403 -1.079212455 
          31           32           33           34           35           36 
 0.063644688 -0.507783883  0.777930403 -0.936355312 -1.079212455 -1.079212455 
          37           38           39           40           41           42 
 0.116179002 -0.598106713 -0.598106713  0.116179002  0.635073260 -0.598106713 
          43           44           45           46           47           48 
-0.507783883  0.635073260  0.116179002 -0.793498169  0.635073260  1.349358974 
          49           50           51           52           53           54 
 0.830464716  0.492216117  0.497131383 -0.598106713 -0.312392427 -0.883820998 
          55           56           57           58           59           60 
 0.973321859 -0.222069597 -1.169535284  0.259036145 -0.455249570 -0.169535284 
          61           62           63           64           65           66 
-0.079212455  0.544750430  1.259036145  0.920787545  0.830464716  2.259036145 
          67           68           69           70           71           72 
-0.650641026 -1.650641026 -0.169535284  1.687607573 -1.026678141  0.401893287 
          73           74           75           76           77           78 
 0.973321859 -1.026678141 -0.598106713  0.973321859  0.849358974 -0.598106713 
          79           80           81           82           83           84 
 0.973321859  0.777930403  1.401893287 -1.364926740 -1.079212455 -0.222069597 
          85           86           87           88           89           90 
 0.492216117  1.687607573 -1.026678141 -0.650641026 -0.312392427 -0.312392427 
          91           92           93           94           95           96 
 1.973321859  0.920787545 -1.169535284  0.116179002 -1.026678141  0.973321859 
          97           98           99          100          101          102 
-0.026678141 -0.598106713 -0.883820998  1.116179002 -0.883820998 -0.169535284 
         103          104          105          106          107          108 
-1.026678141  0.116179002  0.063644688  0.349358974  0.206501831  0.349358974 
         109          110          111          112          113          114 
 1.206501831  0.777930403  0.777930403 -0.079212455  1.206501831  0.349358974 
         115          116          117          118          119          120 
 0.492216117  0.777930403 -0.650641026  0.206501831  0.544750430  0.920787545 
         121          122          123          124          125          126 
-0.222069597  0.349358974 -0.793498169  0.973321859 -0.026678141  1.544750430 
         127          128          129          130          131          132 
 0.259036145 -0.883820998 -1.079212455 -1.026678141 -0.598106713 -0.169535284 
         133          134          135          136          137          138 
 0.259036145 -1.169535284  1.259036145 -0.740963855 -0.169535284 -0.169535284 
         139          140          141          142          143          144 
 0.116179002  1.116179002 -0.026678141 -0.502868617 -0.312392427  1.259036145 
         145          146          147          148          149          150 
 2.544750430 -1.026678141  0.401893287  0.830464716  0.920787545 -1.507783883 
         151          152          153          154          155          156 
 0.920787545 -1.364926740 -0.222069597  0.063644688 -0.312392427  0.349358974 
         157          158          159          160          161          162 
 0.401893287 -0.883820998 -0.455249570 -0.312392427  0.349358974 -1.026678141 
         163          164          165          166          167          168 
 0.687607573 -0.169535284  1.116179002  0.116179002 -0.598106713 -0.669535284 
         169          170          171          172          173          174 
 0.259036145 -0.455249570  0.492216117 -0.936355312 -0.598106713  0.687607573 
         175          176          177          178          179          180 
 0.401893287  0.492216117  0.920787545 -0.364926740 -0.026678141 -0.740963855 
         181          182          183          184          185          186 
-0.026678141 -0.026678141  0.259036145 -1.364926740 -0.598106713 -0.598106713 
         187          188          189          190          191          192 
-1.026678141 -1.169535284 -0.002868617 -0.936355312 -0.740963855  0.687607573 
         193          194          195          196          197          198 
-0.598106713  1.349358974 -0.883820998  0.259036145 -0.364926740 -0.740963855 
         199          200          201          202          203          204 
 0.401893287 -0.883820998 -0.312392427 -0.079212455  0.401893287  0.259036145 
         205          206          207          208          209          210 
 0.687607573 -0.740963855 -0.598106713 -0.455249570  0.259036145  0.259036145 
         211          212          213          214          215          216 
 0.401893287 -0.740963855 -0.312392427  0.635073260 -1.507783883 -0.598106713 
         217          218          219          220          221          222 
 0.973321859 -0.312392427  0.116179002 -0.026678141  1.259036145 -0.169535284 
         223          224          225          226          227          228 
-1.079212455  0.830464716 -0.883820998 -0.026678141  0.401893287  0.635073260 
         229          230          231          232          233          234 
-0.740963855  0.116179002 -0.793498169 -0.598106713 -0.026678141  1.492216117 
         235          236          237          238          239          240 
 0.544750430  0.544750430 -0.312392427 -0.455249570 -0.455249570 -0.936355312 
         241          242          243          244          245          246 
 0.063644688  0.401893287 -0.650641026 -0.312392427  0.401893287  0.259036145 
         247          248          249          250          251          252 
-1.026678141  0.777930403  1.063644688  0.063644688  0.973321859  0.920787545 
         253          254          255          256          257          258 
 0.349358974  0.544750430  0.259036145  0.973321859 -0.455249570 -0.740963855 
         259          260          261          262          263          264 
-0.936355312 -1.169535284 -0.169535284  0.635073260 -0.222069597 -0.222069597 
         265          266          267          268          269          270 
-0.222069597  0.349358974 -0.364926740 -0.079212455 -0.507783883 -0.079212455 </code></pre>
</div>
</div>
</section>
<section id="an-aside-concerning-lm-objects" class="level2">
<h2 class="anchored" data-anchor-id="an-aside-concerning-lm-objects">An aside concerning <code>lm</code> objects</h2>
<ul>
<li><code>lm</code> objects consist of the information embedded in your linear model</li>
<li>R often handles model objects poorly due to them not necessarily being in a usable data frame (lists!)</li>
<li>the <code>broom</code> package makes model objects into dataframes</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>fit.<span class="fl">1.</span>tidy <span class="ot">&lt;-</span> <span class="fu">tidy</span>(mod<span class="fl">.1</span>)  </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>fit.<span class="fl">1.</span>tidy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic   p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)    2.65     0.0764     34.7  3.80e-101
2 tx            -0.481    0.0974     -4.94 1.38e-  6</code></pre>
</div>
</div>
<hr>
<ul>
<li><code>Augment</code> function from the <code>broom</code> package amends the original dataset with lm object content. The new variable names of have a “.” in front of the name to distinguish</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>fit.<span class="fl">1.</span>data <span class="ot">&lt;-</span> <span class="fu">augment</span>(mod<span class="fl">.1</span>) </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>fit.<span class="fl">1.</span>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 270 × 8
   traffic.risk    tx .fitted .resid    .hat .sigma  .cooksd .std.resid
          &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
 1         1.86     1    2.17 -0.312 0.00602  0.780 0.000490     -0.402
 2         1        1    2.17 -1.17  0.00602  0.777 0.00687      -1.51 
 3         3.29     1    2.17  1.12  0.00602  0.777 0.00626       1.44 
 4         2        1    2.17 -0.170 0.00602  0.780 0.000144     -0.218
 5         2.43     1    2.17  0.259 0.00602  0.780 0.000337      0.334
 6         3.29     1    2.17  1.12  0.00602  0.777 0.00626       1.44 
 7         1.17     0    2.65 -1.48  0.00962  0.775 0.0178       -1.91 
 8         2.43     0    2.65 -0.222 0.00962  0.780 0.000398     -0.287
 9         3        0    2.65  0.349 0.00962  0.780 0.000986      0.451
10         1.71     1    2.17 -0.455 0.00602  0.780 0.00104      -0.586
# ℹ 260 more rows</code></pre>
</div>
</div>
</section>
<section id="statistical-inference-1" class="level2">
<h2 class="anchored" data-anchor-id="statistical-inference-1">Statistical Inference</h2>
<ul>
<li><p>To the extent that we can generate different predicted values of Y based on the values of the predictors, our model is doing well</p></li>
<li><p>Said differently, the closer our model is to the “actual” data generating model, our guesses ( <span class="math inline">\(\hat{Y}\)</span> ) will be closer to our actual data ( <span class="math inline">\(Y\)</span> )</p></li>
</ul>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>ggstatsplot<span class="sc">::</span><span class="fu">ggbetweenstats</span>(</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> example.data,</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> tx,</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> traffic.risk,</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Traffic Risk Score"</span>, <span class="co"># label for the x-axis variable</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Treatment group"</span>, <span class="co"># label for the y-axis variable</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">bf.message =</span> <span class="cn">FALSE</span>,</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean.plotting =</span> <span class="cn">TRUE</span>,</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.type =</span> <span class="st">"violin"</span>,</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">messages =</span> <span class="cn">FALSE</span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">2.35</span>)<span class="sc">+</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(.<span class="dv">55</span>,<span class="fl">2.5</span>,<span class="at">label =</span> <span class="st">"Average"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="2-Basics_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="partitioning-the-variation-in-y" class="level2">
<h2 class="anchored" data-anchor-id="partitioning-the-variation-in-y">Partitioning the variation in Y</h2>
<p><span class="math display">\[ \sum (Y_i - \bar{Y})^2 = \sum (\hat{Y}_i -\bar{Y})^2 + \sum(Y_i - \hat{Y}_i)^2 \]</span></p>
<ul>
<li><p>SS total = SS between + SS within</p></li>
<li><p>SS total = SS regression + SS residual (or error)</p></li>
</ul>
</section>
<section id="what-can-we-do-with-this" class="level2">
<h2 class="anchored" data-anchor-id="what-can-we-do-with-this">What can we do with this?</h2>
<ul>
<li>omnibus F tests (ANOVA)</li>
<li>What hypothesis does the omnibus F test test, generally?</li>
</ul>
<p><span class="math display">\[s_{y}^2 = s_{regression}^2 + s_{residual}^2\]</span></p>
<p><span class="math display">\[1 = \frac{s_{regression}^2}{s_{y}^2} + \frac{s_{residual}^2}{s_{y}^2}\]</span></p>
</section>
<section id="coefficient-of-determination" class="level2">
<h2 class="anchored" data-anchor-id="coefficient-of-determination">Coefficient of Determination</h2>
<p><span class="math display">\[\frac{s_{regression}^2}{s_{y}^2} = \frac{SS_{regression}}{SS_{Y}} = R^2\]</span></p>
<ul>
<li>Percent (of total) variance explained by your model…which currently are groups</li>
<li>Another way of asking how much variance group status explains</li>
</ul>
</section>
<section id="r2-and-eta-squared" class="level2">
<h2 class="anchored" data-anchor-id="r2-and-eta-squared"><span class="math inline">\(R^2\)</span> and Eta squared</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod<span class="fl">.1</span>)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08344007</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lsr)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">etaSquared</span>(mod<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       eta.sq eta.sq.part
tx 0.08344007  0.08344007</code></pre>
</div>
</div>
</section>
<section id="r2-for-different-coding-schemes" class="level2">
<h2 class="anchored" data-anchor-id="r2-for-different-coding-schemes"><span class="math inline">\(R^2\)</span> for different coding schemes</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(mod<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic    p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1    0.0834        0.0800 0.779      24.4 0.00000138     1  -315.  635.  646.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(mod.<span class="fl">1.</span>eff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic    p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1    0.0834        0.0800 0.779      24.4 0.00000138     1  -315.  635.  646.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
</div>
</section>
<section id="note-the-r2-p-value" class="level2">
<h2 class="anchored" data-anchor-id="note-the-r2-p-value">Note the <span class="math inline">\(R^2\)</span> <em>p</em>-value</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = traffic.risk ~ tx, data = example.data)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.65064 -0.59811 -0.02668  0.54475  2.54475 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.65064    0.07637  34.707  &lt; 2e-16 ***
tx          -0.48111    0.09740  -4.939 1.38e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7789 on 268 degrees of freedom
Multiple R-squared:  0.08344,   Adjusted R-squared:  0.08002 
F-statistic:  24.4 on 1 and 268 DF,  p-value: 1.381e-06</code></pre>
</div>
</div>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p><img src="regMeme.jpeg" class="img-fluid"></p>
</section>
<section id="summary-1" class="level2">
<h2 class="anchored" data-anchor-id="summary-1">Summary</h2>
<ul>
<li><p>We are using linear models to do the exact same tests as <em>t</em>-tests and ANOVAs</p></li>
<li><p>It is the exact same because <em>t</em>-tests and ANOVAs are part of the general linear model</p></li>
<li><p>The GLM provides a more systematic way at 1) building and testing your theoretical model and 2) comparing between alternative theoretical models</p></li>
<li><p>You can get 1) estimates and 2) fit statistics from the model. Both are important.</p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>